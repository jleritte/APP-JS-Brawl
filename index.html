<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Brawl</title>
  <link rel="stylesheet" href="./css/Brawl.css">
  <link rel="icon" href="./img/favicon.ico">
</head>
<body>
  <select class="who icon">
    <option class="icon Bennett" value="Bennett"></option>
    <option class="icon Chris" value="Chris"></option>
    <option class="icon Darwin" value="Darwin"></option>
    <option class="icon Hale" value="Hale"></option>
    <option class="icon Morgan" value="Morgan"></option>
    <option class="icon Pearl" value="Pearl"></option>
  </select>
  <input type="button" onclick="who.dispatchEvent(change)" value="Shuffle">
  <input type="button" onclick="clearDeck()" value="Clear">
  <div class="grid">
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
    <div class="contain">
      <div>
        <div class="front"></div>
        <div class="back"></div>
      </div>
    </div>
  </div>
  <!--script src="./js/Brawl.js"></script-->
  <script>
    var BENNETT = [7,8,0,1,3,0,1,4,0,1,6,1,3],
        CHRIS =   [4,7,0,2,5,0,2,8,0,2,2,0,3],
        DARWIN =  [3,4,1,3,4,0,1,8,1,3,1,3,3],
        HALE =    [6,5,1,0,8,1,1,4,1,1,4,0,3],
        MORGAN =  [5,8,0,4,6,0,2,2,0,1,4,0,3],
        PEARL =   [5,7,1,1,7,1,1,1,0,1,5,2,3];
    var CARDNAME = ['base', 'hitB', 'hit2B', 'blockB',
                    'hitG', 'hit2G', 'blockG', 'hitR',
                    'hit2R', 'blockR', 'clear', 'press', 'freeze'];
    var DECKSIZE = 35;
    var grid = document.getElementsByClassName('grid')[0],
        who = document.getElementsByClassName('who')[0],
        change = new Event('change');
    who.addEventListener('change',loadDeck);
    who.dispatchEvent(change);
    function loadDeck(e){
      var who = e.target.value;
      e.target.className = 'who icon '+who;
      console.log(who);
      switch(who) {
        case 'Bennett':  show(who,BENNETT);break;
        case 'Chris':    show(who,CHRIS);break;
        case 'Darwin':   show(who,DARWIN);break;
        case 'Hale':     show(who,HALE);break;
        case 'Morgan':   show(who,MORGAN);break;
        case 'Pearl':    show(who,PEARL);break;
        default:         alert('Not a Person!');clearDeck();
      }
    }
    function buildLabels(deck) {
      var i,j, ct=0, bd=[];
      for(i = 0; i < 13; i++){
        for(j = 0; j < deck[i]; j++){
          var front = grid.children[ct].firstElementChild.firstElementChild;
          bd[ct] = CARDNAME[i];
          ct++;
        }
      }
      return bd;
    }
    function _shuffle(deck) {
      for(var i = 31; i > 0; i--) {
        var rand = Math.floor(Math.random() * (i + 1));
        if(rand > 0) {
          temp = deck[i];
          deck[i] = deck[rand];
          deck[rand] = temp;
        }
      }
      return deck;
    }
    function show(name,deck) {
      var deck = buildLabels(deck), ct = 0;
      deck = _shuffle(deck);
      Array.prototype.forEach.call(grid.children, function(elem,i) {
        var tmp = elem.firstElementChild;
        elem.style.zIndex = -(i+1)*5;
        elem.style.left = (i*5)+'px';
        elem.style.top = 51+'px';
        tmp.style.opacity = 1;
        tmp.style.transform = '';
        tmp.className = 'deck card '+name;
        tmp.addEventListener('click',flip);
        tmp.firstElementChild.className = 'front '+deck[i];
        ct++
      });
    }
    function clearDeck(){
      Array.prototype.forEach.call(grid.children, function(elem,i) {
        elem.style.opacity = 0;
      });
    }
    function flip (e) {
      e = e.target;
      var card = e.parentElement,
          contain = card.parentElement,
          left = contain.style.left.replace('px',''),
          zrotate = Math.floor(Math.random() *360);//* 10 + 90);
      contain.style.zIndex = 0;
      card.style.transform = 'rotateY(180deg) rotateZ(' + zrotate + 'deg)';
      card.className = card.className.replace('deck','');
      contain.style.left = 200+'px';
      contain.style.top = 300+'px';
    }
    function div(clss){
      var rtrn = document.createElement('div');
      rtrn.className = clss;
      return rtrn;
    }
  </script>
</body>
</html>